---
title: BGP工作流程
date: 2025/01/30 14:38
author: lele
tags:
  - 外链
sticky: "-1"
mathjax: true
---
### **BGP协议工作流程分条简述**

1. **选择BGP发言人**  
   - 每个自治系统（AS）的管理员指定至少一个**BGP发言人**（通常是边界路由器），负责与其他AS交换路由信息。  
   - **功能**：作为AS对外的“代表”，处理跨AS的路由通信。

---

2. **建立TCP连接**  
   - 不同AS的BGP发言人之间需先**建立TCP连接**（默认端口179），确保数据传输的可靠性。  
   - **作用**：TCP提供可靠传输，避免路由信息丢失或乱序。

---

3. **建立BGP会话**  
   - 在TCP连接上交换**BGP报文**，完成会话初始化（如协商参数）。  
   - **关键报文**：  
     - **OPEN报文**：验证对方身份，确认会话参数。  
     - **KEEPALIVE报文**：维持会话存活状态。  

---

4. **交换路由信息**  
   - BGP发言人通过**UPDATE报文**交换路由信息，内容包括：  
     - **路径向量**：到达目标网络需经过的AS列表（例如：`AS1→AS3→AS5`）。  
     - **网络可达性**：目标网络的IP前缀（如 `192.168.0.0/24`）。  
   - **特点**：BGP交换的是AS级别的路径信息，而非具体网络细节，大幅减少数据量。

---

5. **路由策略选择**  
   - 每个BGP发言人根据**本地策略**（如最短AS路径、商业协议）选择最佳路由。  
   - **示例**：  
     - 若收到两条路径 `AS1→AS2→AS4` 和 `AS1→AS3→AS4`，可能优先选择经过更少AS的路径。  

---

6. **维护路由表与更新**  
   - BGP发言人持续监听网络变化（如链路故障），通过**UPDATE报文**通知邻居。  
   - 若路由失效，发送**WITHDRAW报文**撤销无效路由。  

---

7. **与内部网关协议（IGP）协作**  
   - BGP发言人需同时运行**内部网关协议**（如OSPF、RIP），用于：  
     - 获取AS内部的路由信息，确保跨AS数据包能在本AS内正确转发。  

---

### **BGP核心特点总结**  
- **基于路径向量**：路由决策依赖AS路径，避免环路。  
- **策略驱动**：路由选择受商业策略影响，而不仅是技术最优。  
- **增量更新**：仅传播变化的路由信息，减少带宽消耗。  
- **可靠性保障**：依赖TCP协议，确保数据完整传输。  

通过以上流程，BGP实现了全球互联网中不同自治系统间的路由协调，是维护互联网连通性的核心协议。<br>
{% btn regular::返回::/posts/20250125131300::fa-solid fa-arrow-left %}