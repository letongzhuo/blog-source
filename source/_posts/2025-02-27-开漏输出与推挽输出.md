---
title: 开漏输出与推挽输出
date: 2025/02/27 18:21:56
author: lele
tags:
  - STM32
categories:
---
在STM32或其他微控制器中，**开漏输出**（Open-Drain Output）和**推挽输出**（Push-Pull Output）是两种常见的GPIO输出模式，它们的核心区别在于**电路结构**和**电平驱动方式**。以下是详细解释和对比：

---

### **1. 开漏输出（Open-Drain Output）**
#### **电路结构**
- 仅包含一个N-MOS管（或NPN三极管），漏极（Drain）未连接电源（悬空）。
- **输出高电平**时，MOS管截止，漏极处于高阻态，需**外部上拉电阻**将电平拉高。
- **输出低电平**时，MOS管导通，直接连接到GND。

#### **电平特性**
| 模式       | 输出逻辑 | 实际电平                |
|------------|----------|-------------------------|
| 输出高电平 | 1        | 由外部上拉电阻决定（如3.3V或5V） |
| 输出低电平 | 0        | 接近GND（约0V）          |

#### **特点**
1. **需要外部上拉电阻**：必须外接上拉电阻才能输出高电平。
2. **支持线与（Wire-AND）**：多个开漏引脚可以并联到同一总线，任一设备拉低总线时，总线为低电平。
3. **电平兼容性强**：通过外部上拉电阻可适配不同电压（如3.3V和5V系统互联）。
4. **驱动能力弱**：高电平由外部上拉电阻提供，电流能力有限。

#### **应用场景**
- **I2C总线**：多设备共享总线，支持线与功能。
- **电平转换**：不同电压系统的通信（如3.3V与5V）。
- **需要总线共享**的场景（如多主机通信）。

---

### **2. 推挽输出（Push-Pull Output）**
#### **电路结构**
- 包含两个互补的MOS管（P-MOS和N-MOS）：
  - **P-MOS**连接VDD，负责拉高电平。
  - **N-MOS**连接GND，负责拉低电平。
- **输出高电平**时，P-MOS导通，N-MOS截止，电平直接拉至VDD。
- **输出低电平**时，N-MOS导通，P-MOS截止，电平直接拉至GND。

#### **电平特性**
| 模式       | 输出逻辑 | 实际电平       |
|------------|----------|----------------|
| 输出高电平 | 1        | VDD（如3.3V）  |
| 输出低电平 | 0        | 接近GND（约0V） |

#### **特点**
1. **无需外部上拉电阻**：可直接输出高/低电平。
2. **驱动能力强**：高/低电平均由MOS管主动驱动，电流能力强。
3. **电平固定**：高电平等于VDD，无法直接与其他电压系统兼容。
4. **不支持线与**：多个推挽引脚并联时，若输出不同电平，可能导致短路。

#### **应用场景**
- **驱动LED、继电器**等大电流负载。
- **高速数字信号**（如SPI、UART、PWM）。
- 需要直接输出明确高/低电平的场景。

---

### **对比总结**
| **特性**    | **开漏输出**         | **推挽输出**            |
| --------- | ---------------- | ------------------- |
| **电路结构**  | 仅N-MOS（需外部上拉）    | P-MOS + N-MOS互补结构   |
| **高电平驱动** | 依赖外部上拉电阻         | 由P-MOS直接提供（VDD）     |
| **低电平驱动** | N-MOS导通，直接接地     | N-MOS导通，直接接地        |
| **驱动能力**  | 高电平弱，低电平强        | 高/低电平均强             |
| **线与功能**  | 支持               | 不支持（可能导致短路）         |
| **电平兼容性** | 灵活（适配不同电压）       | 固定（需电平转换芯片）         |
| **静态功耗**  | 低（高电平由上拉电阻提供）    | 低（MOS管交替导通，无静态电流）   |
| **典型应用**  | I2C总线、电平转换、多设备总线 | 驱动负载、高速信号（SPI、UART） |

---

### **关键区别**
1. **驱动方式**：
   - 开漏输出**高电平被动**（依赖外部上拉），**低电平主动**（MOS管导通）。
   - 推挽输出**高/低电平均主动**（由MOS管直接驱动）。

2. **线与功能**：
   - 开漏输出允许多个设备共享总线（任一设备拉低总线即生效）。
   - 推挽输出不可共享总线，否则可能因电平冲突导致短路。

3. **电平兼容性**：
   - 开漏输出通过外部上拉可适配不同电压系统（如3.3V与5V）。
   - 推挽输出的高电平固定为VDD，需额外电路实现电平转换。

---

### **配置示例（STM32 HAL库）**
```c
// 开漏输出（需外接上拉电阻）
GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_OD;  // 开漏模式
GPIO_InitStruct.Pull = GPIO_NOPULL;          // 不启用内部上拉

// 推挽输出（直接驱动高/低电平）
GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;  // 推挽模式
GPIO_InitStruct.Pull = GPIO_NOPULL;           // 不启用上拉/下拉
```

---

### **注意事项**
1. **开漏输出的上拉电阻**：
   - 必须外接上拉电阻（典型值为4.7kΩ），否则无法输出高电平。
   - 上拉电阻的取值需平衡速度和功耗（电阻越小，驱动能力越强，但功耗越高）。

2. **推挽输出的短路风险**：
   - 避免多个推挽引脚直接并联输出不同电平（如一个输出高，另一个输出低）。

3. **电平转换**：
   - 若需连接不同电压系统（如3.3V和5V），优先选择开漏输出 + 外部上拉。

---

### **总结**
- **开漏输出**：适合总线共享、电平转换、低功耗场景，但需外接上拉电阻。
- **推挽输出**：适合驱动负载、高速信号，无需外接电路，但电平固定。

根据具体需求选择输出模式，可显著提高系统可靠性和灵活性。